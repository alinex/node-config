<!DOCTYPE html>
<html>
<head>
  <title>index.coffee</title>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <link rel="stylesheet" media="all" href="../doc-style.css" />
  <script src="../doc-filelist.js"></script>
  <script>
    var relativeDir = "../", thisFile = "home/alex/a3/node-config/src/indexcoffee", defaultSidebar = true;
  </script>
  <script src="../doc-script.js"></script>
  <script src="../fileSearch.js"></script>
  <script src="../goToLine.js"></script>
  <link rel="stylesheet" href="../fileSearch.css" />
  <link rel="stylesheet" href="../goToLine.css" />
</head>
<body>
  <nav>
<div class="logo"><a href="http://alinex.github.io" onmouseover="lllogo.src='https://alinex.github.io/images/Alinex-200.png'" onmouseout="lllogo.src='https://alinex.github.io/images/Alinex-black-200.png'">
  <img name="lllogo" src="https://alinex.github.io/images/Alinex-black-200.png" width="150" title="Alinex Universe Homepage" />
  </a>
  <img src="http://alinex.github.io/images/Alinex-200.png" style="display:none" alt="preloading" />
</div>
<div class="links">
  <a href="http://alinex.github.io/blog" class="btn btn-primary"><span class="glyphicon-cog"></span> Blog</a>
  <a href="http://alinex.github.io/code.html" class="btn btn-warning"><span class="glyphicon-pencil"></span> Code</a>
</div>
</nav><div id="sidebar_wrapper">
    <div id="sidebar_switch">
      <span class="tree">Files</span>
      <span class="headings">Headings</span>
    </div>
    <div id="tree"></div>
    <div id="headings">
      <div class="heading h1">
        <a href="#configuration">Configuration</a>
      </div>
      <div class="heading h2">
        <a href="#architecture">Architecture</a>
      </div>
      <div class="heading h2">
        <a href="#node%20modules">Node Modules</a>
      </div>
      <div class="heading h2">
        <a href="#define%20singleton%20instance">Define singleton instance</a>
      </div>
      <div class="heading h2">
        <a href="#data%20container">Data container</a>
      </div>
      <div class="heading h2">
        <a href="#setup%20methods">Setup methods</a>
      </div>
      <div class="heading h3">
        <a href="#reload">Reload</a>
      </div>
      <div class="heading h2">
        <a href="#access%20methods">Access methods</a>
      </div>
      <div class="heading h3">
        <a href="#initialize">Initialize</a>
      </div>
    </div>
  </div>
  <div id="sidebar-toggle"></div>
  <div id="container" tabindex="0"><a id="fork" href="https://github.com/alinex/node-config" title="Fork me on GitHub"></a><div class="background highlight"></div>
<table cellpadding="0" cellspacing="0">
  <tbody>
      <tr>
        <td class="docs">
<div class="pilwrap" id="configuration">
  <h1>
    <a href="#configuration" name="configuration" class="pilcrow">&#182;</a>
    Configuration
  </h1>
</div>


<p>This package will give you an easy way to load and use configuration settings
into your application or module.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre></pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="architecture">
  <h2>
    <a href="#architecture" name="architecture" class="pilcrow">&#182;</a>
    Architecture
  </h2>
</div>


<p>The configuration handling consists of a singleton class as central information
storage like a registry. On access you will get references to the data.</p>

<p>A special behavior is the reloading of the configuration after the files
changed. This is done using a watcher on the file search path which will
automatically load all configurations which are changed into the class cache.
Through class events the instances will get informed if anything changed, so
they can reload their data and emit events for their application listeners
to update this data, too.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="node%20modules">
  <h2>
    <a href="#node%20modules" name="node%20modules" class="pilcrow">&#182;</a>
    Node Modules
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-4" id="section-4">&#182;</a>
</div>
<p>include base modules</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">debug = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;debug&#39;</span><span class="p">)(</span><span class="s">&#39;config&#39;</span><span class="p">)</span>
<span class="nv">debugValue = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;debug&#39;</span><span class="p">)(</span><span class="s">&#39;config:value&#39;</span><span class="p">)</span>
<span class="nv">debugAccess = </span><span class="nx">require</span><span class="p">(</span><span class="s">&#39;debug&#39;</span><span class="p">)(</span><span class="s">&#39;config:access&#39;</span><span class="p">)</span>
<span class="nv">chalk = </span><span class="nx">require</span> <span class="s">&#39;chalk&#39;</span>
<span class="nv">util = </span><span class="nx">require</span> <span class="s">&#39;util&#39;</span>
<span class="nv">fspath = </span><span class="nx">require</span> <span class="s">&#39;path&#39;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-5" id="section-5">&#182;</a>
</div>
<p>load other alinex modules</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="p">{</span><span class="nx">string</span><span class="p">,</span> <span class="nx">object</span><span class="p">}</span> <span class="o">=</span> <span class="nx">require</span> <span class="s">&#39;alinex-util&#39;</span>
<span class="nv">async = </span><span class="nx">require</span> <span class="s">&#39;alinex-async&#39;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-6" id="section-6">&#182;</a>
</div>
<p>load helper modules</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">load = </span><span class="nx">require</span> <span class="s">&#39;./load&#39;</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="define%20singleton%20instance">
  <h2>
    <a href="#define%20singleton%20instance" name="define%20singleton%20instance" class="pilcrow">&#182;</a>
    Define singleton instance
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">module.exports =</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="data%20container">
  <h2>
    <a href="#data%20container" name="data%20container" class="pilcrow">&#182;</a>
    Data container
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-9" id="section-9">&#182;</a>
</div>
<p>configuration for loading</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">origin: </span><span class="p">[]</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-10" id="section-10">&#182;</a>
</div>
<p>validation schema</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">schema:</span>
    <span class="nv">type: </span><span class="s">&#39;object&#39;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-11" id="section-11">&#182;</a>
</div>
<p>contents</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">value: </span><span class="p">{}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-12" id="section-12">&#182;</a>
</div>
<p>meta data for each data element</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">meta: </span><span class="p">{}</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-13" id="section-13">&#182;</a>
</div>
<p>event listener for onChange event</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">listener: </span><span class="p">{}</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="setup%20methods">
  <h2>
    <a href="#setup%20methods" name="setup%20methods" class="pilcrow">&#182;</a>
    Setup methods
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

  <span class="nv">pushOrigin: </span><span class="nf">(conf) -&gt;</span> <span class="nx">@origin</span><span class="p">.</span><span class="nx">push</span> <span class="nx">conf</span>
  <span class="nv">unshiftOrigin: </span><span class="nf">(conf) -&gt;</span> <span class="nx">@origin</span><span class="p">.</span><span class="nx">unshift</span> <span class="nx">conf</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-15" id="section-15">&#182;</a>
</div>
<p>name - application name
basedir - path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">register: </span><span class="nf">(app, basedir, setup = {} ) -&gt;</span>
    <span class="nv">uri = </span><span class="nx">string</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">setup</span><span class="p">.</span><span class="nx">uri</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">)</span> <span class="o">?</span> <span class="s">&#39;*&#39;</span>
    <span class="nv">folder = </span><span class="nx">setup</span><span class="p">.</span><span class="nx">folder</span> <span class="o">?</span> <span class="s">&#39;config&#39;</span>
    <span class="nv">list = </span><span class="p">[]</span>
    <span class="k">if</span> <span class="nx">basedir</span>
      <span class="nv">dir = </span><span class="nx">fspath</span><span class="p">.</span><span class="nx">resolve</span> <span class="nx">basedir</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-16" id="section-16">&#182;</a>
</div>
<p>add src</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span>
        <span class="nv">uri: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">dir</span><span class="si">}</span><span class="s">/var/src/</span><span class="si">#{</span><span class="nx">folder</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">uri</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nv">parser: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">parser</span>
        <span class="nv">path: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">path</span>
        <span class="nv">filter: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">filter</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-17" id="section-17">&#182;</a>
</div>
<p>add local</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span>
        <span class="nv">uri: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">dir</span><span class="si">}</span><span class="s">/var/local/</span><span class="si">#{</span><span class="nx">folder</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">uri</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nv">parser: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">parser</span>
        <span class="nv">path: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">path</span>
        <span class="nv">filter: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">filter</span>
    <span class="k">if</span> <span class="nx">app</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-18" id="section-18">&#182;</a>
</div>
<p>add global</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span>
        <span class="nv">uri: </span><span class="s">&quot;/etc/</span><span class="si">#{</span><span class="nx">app</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">folder</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">uri</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nv">parser: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">parser</span>
        <span class="nv">path: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">path</span>
        <span class="nv">filter: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">filter</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-19" id="section-19">&#182;</a>
</div>
<p>add user</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
      <span class="nv">dir = </span><span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">HOME</span> <span class="o">?</span> <span class="nx">process</span><span class="p">.</span><span class="nx">env</span><span class="p">.</span><span class="nx">USERPROFILE</span>
      <span class="nx">list</span><span class="p">.</span><span class="nx">push</span>
        <span class="nv">uri: </span><span class="s">&quot;</span><span class="si">#{</span><span class="nx">dir</span><span class="si">}</span><span class="s">/.</span><span class="si">#{</span><span class="nx">app</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">folder</span><span class="si">}</span><span class="s">/</span><span class="si">#{</span><span class="nx">uri</span><span class="si">}</span><span class="s">&quot;</span>
        <span class="nv">parser: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">parser</span>
        <span class="nv">path: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">path</span>
        <span class="nv">filter: </span><span class="nx">setup</span><span class="p">.</span><span class="nx">filter</span>
    <span class="nx">@origin</span><span class="p">.</span><span class="nx">push</span> <span class="nx">list</span>

  <span class="nv">setSchema: </span><span class="nf">(path, schema, cb = -&gt; ) -&gt;</span>
    <span class="nv">path = </span><span class="nx">string</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">).</span><span class="nx">split</span> <span class="s">&#39;/&#39;</span>
    <span class="nv">ref = </span><span class="nx">@schema</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-20" id="section-20">&#182;</a>
</div>
<p>go into path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">if</span> <span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">and</span> <span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
      <span class="k">for</span> <span class="nx">p</span> <span class="k">in</span> <span class="nx">path</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-21" id="section-21">&#182;</a>
</div>
<p>create structure if missing</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
        <span class="nx">ref</span><span class="p">.</span><span class="nx">type</span> <span class="o">?=</span> <span class="s">&#39;object&#39;</span>
        <span class="nx">ref</span><span class="p">.</span><span class="nx">keys</span> <span class="o">?=</span> <span class="p">{}</span>
        <span class="nx">ref</span><span class="p">.</span><span class="nx">keys</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span> <span class="o">?=</span> <span class="p">{}</span>
        <span class="nv">ref = </span><span class="nx">ref</span><span class="p">.</span><span class="nx">keys</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-22" id="section-22">&#182;</a>
</div>
<p>remove previous settings</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">delete</span> <span class="nx">ref</span><span class="p">[</span><span class="nx">k</span><span class="p">]</span> <span class="k">for</span> <span class="nx">k</span> <span class="k">of</span> <span class="nx">ref</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-23" id="section-23">&#182;</a>
</div>
<p>set new schema</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">object</span><span class="p">.</span><span class="nx">extend</span> <span class="nx">ref</span><span class="p">,</span> <span class="nx">schema</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-24" id="section-24">&#182;</a>
</div>
<p>revalidate if already loaded</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="k">return</span> <span class="nx">cb</span><span class="p">()</span> <span class="k">if</span> <span class="nx">object</span><span class="p">.</span><span class="nx">isEmpty</span> <span class="nx">@value</span>
    <span class="nx">debug</span> <span class="s">&quot;revalidate against schema because </span><span class="si">#{</span><span class="nx">path</span> <span class="o">?</span> <span class="s">&#39;/&#39;</span><span class="si">}</span><span class="s"> changed&quot;</span>
    <span class="nx">load</span><span class="p">.</span><span class="nx">validate</span> <span class="k">this</span><span class="p">,</span> <span class="nx">@value</span><span class="p">,</span> <span class="nf">(err, value) -&gt;</span>
      <span class="k">return</span> <span class="nx">cb</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>
      <span class="vi">@value = </span><span class="nx">value</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="reload">
  <h3>
    <a href="#reload" name="reload" class="pilcrow">&#182;</a>
    Reload
  </h3>
</div>


<p>This will re-import everything from scratch and if successful overwrite the
previous values.</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
  <span class="nv">reload: </span><span class="nf">(cb) -&gt;</span>
    <span class="nx">debug</span> <span class="s">&quot;reload configuration system&quot;</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-26" id="section-26">&#182;</a>
</div>
<p>step through origins and set as unloaded</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nv">origin.loaded = </span><span class="kc">false</span> <span class="k">for</span> <span class="nx">origin</span> <span class="k">in</span> <span class="nx">load</span><span class="p">.</span><span class="nx">listOrigins</span> <span class="nx">@origin</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-27" id="section-27">&#182;</a>
</div>
<p>run init again</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nx">load</span><span class="p">.</span><span class="nx">init</span> <span class="k">this</span><span class="p">,</span> <span class="nf">(err) =&gt;</span>
      <span class="k">return</span> <span class="nx">cb</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>
      <span class="nx">debugValue</span> <span class="s">&quot;new configuration \n</span><span class="si">#{</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">grey</span> <span class="nx">util</span><span class="p">.</span><span class="nx">inspect</span> <span class="nx">@value</span><span class="p">,</span> <span class="p">{</span><span class="nv">depth: </span><span class="kc">null</span><span class="si">}</span><span class="s">}&quot;</span>
      <span class="nx">cb</span><span class="p">()</span>



</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="access%20methods">
  <h2>
    <a href="#access%20methods" name="access%20methods" class="pilcrow">&#182;</a>
    Access methods
  </h2>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>

  <span class="nv">get: </span><span class="nf">(path) -&gt;</span>
    <span class="k">if</span> <span class="k">typeof</span> <span class="nx">path</span> <span class="o">is</span> <span class="s">&#39;string&#39;</span>
      <span class="nv">path = </span><span class="nx">string</span><span class="p">.</span><span class="nx">trim</span><span class="p">(</span><span class="nx">path</span><span class="p">,</span> <span class="s">&#39;/&#39;</span><span class="p">).</span><span class="nx">split</span> <span class="s">&#39;/&#39;</span>
      <span class="nx">debugAccess</span> <span class="s">&quot;returning </span><span class="si">#{</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;/&#39;</span><span class="si">}</span><span class="s">&quot;</span>
    <span class="k">return</span> <span class="nx">@value</span> <span class="k">unless</span> <span class="nx">path</span><span class="p">.</span><span class="nx">length</span> <span class="o">and</span> <span class="nx">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap">
  <a class="pilcrow" href="#section-29" id="section-29">&#182;</a>
</div>
<p>get sub path</p>
        </td>
        <td class="code highlight"><div class="highlight"><pre>
    <span class="nv">ref = </span><span class="nx">@value</span>
    <span class="k">for</span> <span class="nx">p</span> <span class="k">in</span> <span class="nx">path</span>
      <span class="k">return</span> <span class="kc">null</span> <span class="k">unless</span> <span class="nx">ref</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span><span class="o">?</span>
      <span class="nv">ref = </span><span class="nx">ref</span><span class="p">[</span><span class="nx">p</span><span class="p">]</span>
    <span class="nx">debugAccess</span> <span class="s">&quot;not found </span><span class="si">#{</span><span class="nx">path</span><span class="p">.</span><span class="nx">join</span> <span class="s">&#39;/&#39;</span><span class="si">}</span><span class="s">&quot;</span> <span class="k">unless</span> <span class="nx">ref</span><span class="o">?</span>
    <span class="k">return</span> <span class="nx">ref</span>


</pre></div>
        </td>
      </tr>
      <tr>
        <td class="docs">
<div class="pilwrap" id="initialize">
  <h3>
    <a href="#initialize" name="initialize" class="pilcrow">&#182;</a>
    Initialize
  </h3>
</div>

        </td>
        <td class="code highlight"><div class="highlight"><pre>
<span class="nv">module.exports.init = </span><span class="nx">async</span><span class="p">.</span><span class="nx">onceTime</span> <span class="nx">module</span><span class="p">.</span><span class="nx">exports</span><span class="p">,</span> <span class="nf">(cb) -&gt;</span>
  <span class="nv">needLoad = </span><span class="kc">false</span>
  <span class="k">for</span> <span class="nx">origin</span> <span class="k">in</span> <span class="nx">load</span><span class="p">.</span><span class="nx">listOrigins</span> <span class="nx">@origin</span>
    <span class="k">continue</span> <span class="k">if</span> <span class="nx">origin</span><span class="p">.</span><span class="nx">loaded</span>
    <span class="nv">needLoad = </span><span class="kc">true</span>
    <span class="k">break</span>
  <span class="k">return</span> <span class="nx">cb</span><span class="p">()</span> <span class="k">unless</span> <span class="nx">needLoad</span>
  <span class="nx">debug</span> <span class="s">&quot;initialize configuration system&quot;</span>
  <span class="nx">load</span><span class="p">.</span><span class="nx">init</span> <span class="k">this</span><span class="p">,</span> <span class="nf">(err) =&gt;</span>
    <span class="k">return</span> <span class="nx">cb</span> <span class="nx">err</span> <span class="k">if</span> <span class="nx">err</span>
    <span class="nx">debugValue</span> <span class="s">&quot;new configuration \n</span><span class="si">#{</span><span class="nx">chalk</span><span class="p">.</span><span class="nx">grey</span> <span class="nx">util</span><span class="p">.</span><span class="nx">inspect</span> <span class="nx">@value</span><span class="p">,</span> <span class="p">{</span><span class="nv">depth: </span><span class="kc">null</span><span class="si">}</span><span class="s">}&quot;</span>
    <span class="nx">cb</span><span class="p">()</span>
</pre></div>
        </td>
      </tr>
  </tbody>
</table>
  </div>
</body>
</html>
